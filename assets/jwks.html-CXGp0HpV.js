import{_ as n,c as a,a as e,o as l}from"./app-IFqOQRSw.js";const i={};function t(p,s){return l(),a("div",null,s[0]||(s[0]=[e(`<h1 id="jwks-json-web-key-set" tabindex="-1"><a class="header-anchor" href="#jwks-json-web-key-set"><span>JWKS(JSON Web Key Set)</span></a></h1><ul><li><p>JWT(JSON Web Token)는 웹 애플리케이션에서 인증 및 정보 교환을 안전하게 수행하기 위해 사용됨.</p><ul><li>많은 서비스에서 사용되고 있음.</li></ul></li><li><p>JWT는 자체적으로 정보를 담고 있으며, 일반적으로 사용자 식별 및 권한 정보를 포함함.</p><ul><li>JWT는 통상적으로 사용자 인증, 사용자 정보에 사용되며, 웹 애플리케이션에서 안전한 인증을 위해 사용할 수 있는 도구임.</li></ul></li><li><p>JWT의 핵심은 서명을 통해 토큰의 무결성을 보장하는 것임. JWT의 서명에는 대칭 암호화(HMAC)와 비대칭 암호화(RSA, EC) 방식을 사용할 수 있음.</p><ul><li>대칭 암호화(HMAC) : 같은 비밀 키(Secret Key)를 사용하여 서명과 검증을 수행함. <ul><li>예시) HS256, HS384, HS512</li></ul></li><li>비대칭 암호화(RSA, EC) : 개인 키로 서명하고 공개 키로 검증함. <ul><li>예시) RS256, ES256</li></ul></li></ul></li><li><p>비대칭 암호화 방식을 사용할 경우, 클라인언트가 JWT의 서명을 검증할 수 있도록 JWT EndPoint를 제공하여 공개 키를 공유하기도 함.</p><ul><li>이때 사용하는 기술이 JWKS(JSON Web Key Set)임.</li></ul></li><li><p>JWKS는 JSON 형식으로 공개 키를 제공하는 표준 규격으로, 클라이언트를 이를 통해 JWT의 서명을 검증할 수 있음.</p></li></ul><h2 id="jwks는-무엇인가" tabindex="-1"><a class="header-anchor" href="#jwks는-무엇인가"><span>JWKS는 무엇인가</span></a></h2><h3 id="jwk-vs-jwks" tabindex="-1"><a class="header-anchor" href="#jwk-vs-jwks"><span>JWK vs JWKS</span></a></h3><ul><li><strong>JWK(JSON Web Key)</strong><ul><li>JSON 형식으로 표현된 단일 키(비대칭 키 쌍의 공개 키 또는 대칭 키)임.</li><li>JWK는 키의 식별자, 키 타입, 알고리즘 등과 같은 메타데이터를 포함함.</li></ul></li><li><strong>JWKS(JSON Web Key Set)</strong><ul><li>JWKS는 JWK를 여러 개를 포함한 키의 집함임.</li><li>보통 HTTPS를 통해 노출되는 엔드포인트에서 제공되며, 클라이언트는 이를 통해 JWT를 검증함.</li></ul></li></ul><h3 id="jwks-구조" tabindex="-1"><a class="header-anchor" href="#jwks-구조"><span>JWKS 구조</span></a></h3><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;keys&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">&quot;kty&quot;</span><span class="token operator">:</span> <span class="token string">&quot;EC&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;crv&quot;</span><span class="token operator">:</span> <span class="token string">&quot;P-256&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;x&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MKBCTNIcKUSDii11ySs3526iDZ8AiTo7Tu6KPAqv7D4&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;y&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4Etl6SRW2YiLUrN5vfvVHuhp7x8PxltmWWlbbM4IFyM&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;use&quot;</span><span class="token operator">:</span> <span class="token string">&quot;enc&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;kid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">&quot;kty&quot;</span><span class="token operator">:</span> <span class="token string">&quot;RSA&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;n&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0vx7agoebGcQSuuPiLJXZptN9nndrQmbXEps2aiAFbWhM78LhWx4cbbfAAtVT86zwu1RK7aPFFxuhDR1L6tSoc_BJECPebWKRXjBZCiFV4n3oknjhMstn64tZ_2W-5JsGY4Hc5n9yBXArwl93lqt7_RN5w6Cf0h4QyQ5v-65YGjQR0_FDW2QvzqY368QQMicAtaSqzs8KJZgnYb9c7d0zgdAZHzu6qMQvRL5hajrn1n91CbOpbISD08qNLyrdkt-bFTWhAI4vMQFh6WeZu0fM4lFd2NcRwr3XPksINHaQ-G_xBniIqbw0Ls1jF44-csFCur-kEgU8awapJzKnqDKgw&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;e&quot;</span><span class="token operator">:</span> <span class="token string">&quot;AQAB&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;alg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;RS256&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;kid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2011-04-29&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>JWKS는 JSON 배열 형태로 JWK의 집합을 나타냄. 각 JWK 객체는 다음과 같은 필드를 가질 수 있음.</p></li><li><p>kty(key type)</p><ul><li>이 파라미터는 암호 알고리즘을 식별할 때 사용함. RSA, EC 같은 값을 갖는다.</li><li><em><strong>필수요소</strong></em></li></ul></li><li><p>use(public key use)</p><ul><li>이 파라미터는 공개 키(public key) 사용 목적을 식별함. sig(signature), enc(encryption) 같은 값을 가짐.</li><li><em><strong>선택요소</strong></em></li></ul></li><li><p>alg(algorithm)</p><ul><li>이 파라미터는 키와 함께 사용되는 알고리즘 정보를 식별할 때 사용함.</li><li><em><strong>선택요소</strong></em></li></ul></li><li><p>kid(key id)</p><ul><li>JWKS 객체에 담긴 JWKS 객체들은 자신을 구분할 수 있도록 서로 다른 kid 값을 가짐.</li><li><em><strong>선택요소</strong></em></li></ul></li><li><p>추가속성</p><ul><li>kty과 alg에 따라서 추가로 필요한 속성 값이 다름.</li><li>RSA key type의 경우에는 n(public key modulus), e(exponent)가 추가로 필요하고 Base64URL로 인코딩된 값임.</li><li>EC key type의 경우엔 crv(curve type), x, y(coordinates)</li><li><em><strong>선택요소</strong></em></li></ul></li></ul><h3 id="jwks-endpoint" tabindex="-1"><a class="header-anchor" href="#jwks-endpoint"><span>JWKS Endpoint</span></a></h3><ul><li>JWKS는 보통 HTTPS를 통해 제공되며 클라이언트는 이를 활용하여 JWT를 검증함. 일반적으로 URL 형식은 아래와 같음.</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">https://&lt;server_domain&gt;/.well-known/jwks.json</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>RSA 공개 키, 개인 키 생성하는 방법 <ul><li>비대칭 암호화로 RSA를 사용함. 공개 키와 개인 키를 생성하기 위해 <code>openssl</code>를 사용한다.</li></ul></li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">openssl genpkey <span class="token parameter variable">-algorithm</span> RSA <span class="token parameter variable">-out</span> private.key <span class="token parameter variable">-pkeyopt</span> rsa_keygen_bits:2048</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>위 명령어를 통해 개인 키가 생성되었음. 개인 키에서 아래와 같은 명령어를 사용하여 공개키를 추출함.</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">openssl rsa <span class="token parameter variable">-pubout</span> <span class="token parameter variable">-in</span> private.key <span class="token parameter variable">-out</span> public.key</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="jwks-생성" tabindex="-1"><a class="header-anchor" href="#jwks-생성"><span>JWKS 생성</span></a></h3><ul><li>JWKS 생성은 <a href="https://github.com/MicahParks/jwkset" target="_blank" rel="noopener noreferrer">JWKSet 라이브러리</a>를 사용하여 쉽게 구현 가능함. <ul><li>API Endpoint로 구현은 하지 않음. 간단한 예제로 unit test 형식으로 작성함.</li></ul></li></ul><div class="language-golang line-numbers-mode" data-highlighter="prismjs" data-ext="golang"><pre><code><span class="line">func (suite *jwksTestSuite) generateJWKS() (jwkset.JWKSMarshal, error) {</span>
<span class="line">	pubKey, err := parsePublicKey(suite.publicKey)</span>
<span class="line">	if err != nil {</span>
<span class="line">		return jwkset.JWKSMarshal{}, err</span>
<span class="line">	}</span>
<span class="line"></span>
<span class="line">	jwk, err := jwkset.NewJWKFromKey(pubKey, jwkset.JWKOptions{</span>
<span class="line">		Marshal: jwkset.JWKMarshalOptions{</span>
<span class="line">			Private: false,</span>
<span class="line">		},</span>
<span class="line">		Metadata: jwkset.JWKMetadataOptions{</span>
<span class="line">			USE: jwkset.UseSig,</span>
<span class="line">		},</span>
<span class="line">	})</span>
<span class="line">	if err != nil {</span>
<span class="line">		return jwkset.JWKSMarshal{}, err</span>
<span class="line">	}</span>
<span class="line"></span>
<span class="line">	if err := suite.jwkCache.KeyWrite(suite.ctx, jwk); err != nil {</span>
<span class="line">		return jwkset.JWKSMarshal{}, err</span>
<span class="line">	}</span>
<span class="line"></span>
<span class="line">	jwkMarshal, err := suite.jwkCache.Marshal(suite.ctx)</span>
<span class="line">	if err != nil {</span>
<span class="line">		return jwkset.JWKSMarshal{}, err</span>
<span class="line">	}</span>
<span class="line">	return jwkMarshal, nil</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>파싱된 공개 키로부터 jwkset.NewJWKFromKey 함수를 사용하여 JWK를 생성함. <ul><li>. 생성된 JWKS를 메모리 내 JWK cache에 저장하고 marshal 하여 데이터를 반환하는 코드임.</li></ul></li></ul><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;keys&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">&quot;kty&quot;</span><span class="token operator">:</span> <span class="token string">&quot;RSA&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;use&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sig&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;n&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ueE7_FhlT2gYKB8AQEjhBHpB-yS93P5TUUlVFgeI4sWZ7tnpAtrOj15WzVpOEU11hFYq1-UzEwFZI2DJQ7WOJIF9Ry63hXUTV5TZTBZoNfUAV7aaQV5G8YK6CXc6kBpghOoYcABjy0KvLUe6STU2tXPaFoASJq9MVgMZ_FpwKQrGoHHq4WQqpfu9wEnxaHu1qFYDQCAAqApoJSVeBrkVZR98hbQf0G53JbLyUZkzd6toNbCdUuOjzC7aq5ZP1GIDsNsRooUjrkE4TQjDznl0O6l8bmzOLqYcDimMPYRYtmVh_5U6uWmCLOmtp2ErQRaXovkDq-7mpb-zCSaec3HVzw&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;e&quot;</span><span class="token operator">:</span> <span class="token string">&quot;AQAB&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="참고한-글" tabindex="-1"><a class="header-anchor" href="#참고한-글"><span>참고한 글</span></a></h2><ul><li><a href="https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-key-sets" target="_blank" rel="noopener noreferrer">JSON Web Key Sets</a></li><li><a href="https://blog.advenoh.pe.kr/jwks-json-web-key-set%EC%9D%B4%EB%9E%80/" target="_blank" rel="noopener noreferrer">JWKS(JSON Web Key Set)이란?</a></li></ul>`,22)]))}const o=n(i,[["render",t]]),c=JSON.parse('{"path":"/software-engineering/back-end/jwks.html","title":"JWKS(JSON Web Key Set)","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"JWKS는 무엇인가","slug":"jwks는-무엇인가","link":"#jwks는-무엇인가","children":[{"level":3,"title":"JWK vs JWKS","slug":"jwk-vs-jwks","link":"#jwk-vs-jwks","children":[]},{"level":3,"title":"JWKS 구조","slug":"jwks-구조","link":"#jwks-구조","children":[]},{"level":3,"title":"JWKS Endpoint","slug":"jwks-endpoint","link":"#jwks-endpoint","children":[]},{"level":3,"title":"JWKS 생성","slug":"jwks-생성","link":"#jwks-생성","children":[]}]},{"level":2,"title":"참고한 글","slug":"참고한-글","link":"#참고한-글","children":[]}],"git":{"updatedTime":1766035464000,"contributors":[{"name":"HyunSang Lev Park","username":"","email":"me@hyunsang.dev","commits":1}],"changelog":[{"hash":"ed2ffa4dffaa7bbe872a1c67e1b109f124d2c16e","time":1766035464000,"email":"me@hyunsang.dev","author":"HyunSang Lev Park","message":"Go언어를 통한 JWKS 예제"}]},"filePathRelative":"software-engineering/back-end/jwks.md"}');export{o as comp,c as data};
